<?php
namespace Kyrne\Shout\Commands; use Flarum\Settings\SettingsRepositoryInterface; use Illuminate\Contracts\Hashing\Hasher; use Kyrne\Shout\Encryption; class SaveEncryptionKeysHandler { public function handle(SaveEncryptionKeys $sp07d2ef) { $sp63f786 = $sp07d2ef->actor; $sp369360 = $sp07d2ef->data; $sp087b35 = app(SettingsRepositoryInterface::class)->get('kyrne-shout.set_own_password') ? app(Hasher::class)->make($sp369360['password']) : ''; $spaaa5dd = Encryption::populate($sp63f786, $sp369360['encryptedIdentity'], $sp369360['preKeys'], $sp369360['bundle'], $sp087b35); $spaaa5dd->save(); return $spaaa5dd; } }