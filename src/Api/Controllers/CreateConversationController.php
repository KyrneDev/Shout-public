<?php
namespace Kyrne\Shout\Api\Controllers; use Kyrne\Shout\Api\Serializers\ConversationSerializer; use Flarum\Api\Controller\AbstractCreateController; use Illuminate\Contracts\Bus\Dispatcher; use Illuminate\Support\Arr; use Kyrne\Shout\Commands\StartConversation; use Psr\Http\Message\ServerRequestInterface; use Tobscure\JsonApi\Document; class CreateConversationController extends AbstractCreateController { public $serializer = ConversationSerializer::class; public $include = array('messages', 'recipients', 'recipients.user'); protected $bus; public function __construct(Dispatcher $sp9afba9) { $this->bus = $sp9afba9; } protected function data(ServerRequestInterface $sp00f8d1, Document $speb2504) { $sp63f786 = $sp00f8d1->getAttribute('actor'); $spad5e71 = $this->bus->dispatch(new StartConversation($sp63f786, Arr::get($sp00f8d1->getParsedBody(), 'data', array()))); return $spad5e71; } }