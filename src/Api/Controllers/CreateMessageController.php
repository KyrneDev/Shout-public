<?php
namespace Kyrne\Shout\Api\Controllers; use Flarum\Api\Controller\AbstractCreateController; use Illuminate\Contracts\Bus\Dispatcher; use Illuminate\Support\Arr; use Kyrne\Shout\Api\Serializers\MessageSerializer; use Kyrne\Shout\Commands\NewMessage; use Psr\Http\Message\ServerRequestInterface; use Tobscure\JsonApi\Document; class CreateMessageController extends AbstractCreateController { public $serializer = MessageSerializer::class; public $include = array('user'); protected $bus; public function __construct(Dispatcher $spe8efae) { $this->bus = $spe8efae; } protected function data(ServerRequestInterface $spc1c877, Document $spb8026c) { $spd4bab0 = $spc1c877->getAttribute('actor'); $sp2a3d03 = $this->bus->dispatch(new NewMessage($spd4bab0, Arr::get($spc1c877->getParsedBody(), 'data', array()))); return $sp2a3d03; } }